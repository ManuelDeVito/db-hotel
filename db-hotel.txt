Seleziona tutti gli ospiti che sono stati identificati con la carta di identità.

SELECT *
FROM `ospiti`
WHERE `document_type` = 'CI';

Seleziona tutti gli ospiti che sono nati dopo il 1988.

SELECT *
FROM ospiti
WHERE YEAR(date_of_birth) > 1988;

Seleziona tutti gli ospiti che hanno più di 20anni (al momento
dell’esecuzione della query).

SELECT *
FROM `ospiti`
WHERE TIMESTAMPDIFF(YEAR,date_of_birth,CURRENT_DATE) > 20;

Seleziona tutti gli ospiti il cui nome inizia con la D.

SELECT *
FROM ospiti
WHERE name LIKE 'D%';

Calcola il totale degli ordini accepted.

SELECT COUNT(status) 
FROM `pagamenti`
WHERE `status` = 'accepted';

Qual'è il prezzo massimo pagato?

SELECT MAX(Price)
FROM pagamenti;

Seleziona gli ospiti riconosciuti con patente e nati nel 1975.

SELECT * 
FROM `ospiti`
WHERE YEAR(date_of_birth) = 1975
AND `document_type` = 'Driver License';

Quanti paganti sono anche ospiti?

SELECT COUNT(ospite_id)
FROM `paganti`
WHERE `ospite_id` IS NOT NULL;

Quanti posti letto ha l’hotel in totale?

SELECT SUM(beds)
FROM `stanze`;


///////////////////////////////////////////////////////////////////////////////////////////////////////////


GROUP BY

Conta gli ospiti raggruppandoli per anno di nascita.

SELECT COUNT(date_of_birth), YEAR(date_of_birth) 
FROM `ospiti`
GROUP BY YEAR(date_of_birth);

Somma i prezzi dei pagamenti raggruppandoli per status.
 
SELECT `status`, SUM(Price)
FROM `pagamenti`
GROUP BY `status`;

Conta quante volte è stata prenotata ogni stanza.

SELECT COUNT(stanza_id)
FROM `prenotazioni`
GROUP BY `stanza_id`;

Fai una analisi per vedere se ci sono ore in cui le prenotazioni sono
più frequenti.

SELECT COUNT(*), HOUR(created_at)
FROM `prenotazioni` 
GROUP BY HOUR(created_at) 
ORDER BY COUNT(*) DESC;

Quante prenotazioni ha fatto l’ospite che ha fatto più prenotazioni?

SELECT COUNT(ospite_id), `ospite_id` 
FROM `prenotazioni_has_ospiti`
GROUP BY `ospite_id`
ORDER BY COUNT(ospite_id) DESC LIMIT 2;


///////////////////////////////////////////////////////////////////////////////////////////////////////////


JOIN